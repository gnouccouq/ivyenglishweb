<!DOCTYPE html>
<html lang="vi">
    <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="google-site-verification" content="SIO0aKLY9cZk8-k09UBuQ6r3zaNIMu_pswgELE3FVWw" />
    <title>ivyEnglish - Blog</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="canonical" href="https://ivyenglish.io.vn/ivyenglish-blog.html" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="stylesheet" href="https://unpkg.com/swiper/swiper-bundle.min.css" /> 
    <link rel="icon" type="image/png" href="images/favicon.png">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700;900&display=swap" rel="stylesheet">
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
</head>
<body>
    <div id="preloader">
        <div class="loader-content">
            <div class="logo-wrapper">
                <img src="images/logo.png" alt="Logo" class="loader-logo">
                <div class="spinner"></div>
            </div>
        </div>
    </div>
    <!-- Navbar -->
    <div id="header-placeholder"></div>
    <!-- End Navbar -->

    <!-- Blog Content -->
    <section data-aos="fade-up" class="blog-section" style="padding: 50px 20px; max-width: 1200px; margin: auto;">
        <div data-aos="fade-right" id="blog-container">
            <div class="logo-wrapper">
                <img src="images/logo.png" alt="Logo" class="loader-logo">
                <div class="spinner"></div>
            </div>
        </div>
    </section>
    <!-- End Blog Content -->

     <div class="floating-contact">
        <a href="#" class="float-btn scroll-to-top" title="L√™n ƒë·∫ßu trang">
            <i class="fas fa-arrow-up"></i>
        </a>
        <a href="tel:0969730433" class="float-btn hotline" title="Hotline">
            <i class="fas fa-phone-alt"></i>
        </a>
        <a href="https://zalo.me/0969730433" target="_blank" class="float-btn zalo" title="Chat Zalo">
            <img src="https://upload.wikimedia.org/wikipedia/commons/9/91/Icon_of_Zalo.svg" alt="Zalo">
        </a>
        <a href="https://www.facebook.com/profile.php?id=61576482823082" target="_blank" class="float-btn facebook-messenger" title="Nh·∫Øn tin Messenger">
            <i class="fab fa-facebook-messenger"></i>
        </a>
    </div>

    <div id="footer-placeholder"></div>

    <script src="https://unpkg.com/swiper/swiper-bundle.min.js"></script>
    <script src="js/main.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
        const snowContainer = document.body;
        const snowflakesCount = 40;

        for (let i = 0; i < snowflakesCount; i++) {
            createSnowflake(snowContainer);
        }

        // --- 3. X·ª≠ l√Ω Cu·ªôn Trang (Back to Top) ---
        const scrollToTopButton = document.querySelector('.scroll-to-top');

        window.onscroll = function() {
            if (document.body.scrollTop > 300 || document.documentElement.scrollTop > 300) {
                scrollToTopButton.style.display = "flex";
            } else {
                scrollToTopButton.style.display = "none";
            }
        };

        scrollToTopButton.addEventListener('click', function(e) {
            e.preventDefault();
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
        });
        
    let allPosts = []; // Bi·∫øn l∆∞u tr·ªØ to√†n b·ªô b√†i vi·∫øt ƒë·ªÉ d√πng cho m·ª•c "T·∫•t c·∫£"
    let visibleCount = 6;    

    async function loadBlogPosts() {
        const container = document.getElementById('blog-container');
        const API_POSTS = "https://sheetdb.io/api/v1/stjh3ikcs21t8?sheet=Posts";

        try {
            const response = await fetch(API_POSTS);
            const data = await response.json();

            if (!data || data.length === 0) {
                container.innerHTML = "<p>Ch∆∞a c√≥ b√†i vi·∫øt n√†o ƒë∆∞·ª£c ƒëƒÉng.</p>";
                return;
            }

            // ƒê·∫£o ng∆∞·ª£c ƒë·ªÉ b√†i m·ªõi nh·∫•t l√™n ƒë·∫ßu
            allPosts = data.reverse();

            // 1. ƒê·ªãnh nghƒ©a th·ª© t·ª± ∆∞u ti√™n c√°c m·ª•c
            const priorityOrder = ["Tuy·ªÉn sinh", "T√†i li·ªáu", "Tin t·ª©c", "Kinh nghi·ªám"];

            // 2. Nh√≥m b√†i vi·∫øt theo category
            const groupedPosts = allPosts.reduce((groups, post) => {
                const category = post.category || "Tin t·ª©c kh√°c";
                if (!groups[category]) groups[category] = [];
                groups[category].push(post);
                return groups;
            }, {});

            let finalHtml = "";

            // 3. Hi·ªÉn th·ªã c√°c m·ª•c theo th·ª© t·ª± ∆∞u ti√™n ƒë√£ ƒë·ªãnh nghƒ©a
            priorityOrder.forEach(cat => {
                if (groupedPosts[cat] && groupedPosts[cat].length > 0) {
                    finalHtml += renderCategorySection(cat, groupedPosts[cat]);
                }
            });

            // 4. Hi·ªÉn th·ªã c√°c m·ª•c c√≤n l·∫°i (n·∫øu c√≥ category kh√°c ngo√†i danh s√°ch ∆∞u ti√™n)
            for (const cat in groupedPosts) {
                if (!priorityOrder.includes(cat)) {
                    finalHtml += renderCategorySection(cat, groupedPosts[cat]);
                }
            }

            // 5. Th√™m m·ª•c "T·∫•t c·∫£ b√†i vi·∫øt" ·ªü cu·ªëi c√πng
            finalHtml += `
                <div class="category-divider" data-aos="fade-right">
                    <h2>T·∫•t c·∫£ b√†i vi·∫øt</h2>
                    <div class="line"></div>
                </div>
                <div id="all-posts-grid" class="blog-group">
                    ${renderPosts(allPosts.slice(0, visibleCount))}
                </div>
                <div id="load-more-container" style="text-align: center; margin-top: 30px;">
                    ${allPosts.length > visibleCount ? '<button onclick="loadMorePosts()" class="btn-loadmore">Xem th√™m b√†i vi·∫øt</button>' : ''}
                </div>
            `;

            container.style.display = "block";
            container.innerHTML = finalHtml;

        } catch (error) {
            console.error("L·ªói t·∫£i b√†i vi·∫øt:", error);
            container.innerHTML = "<p>Kh√¥ng th·ªÉ t·∫£i b√†i vi·∫øt l√∫c n√†y.</p>";
        }
    }

    function renderCategorySection(title, posts) {
        const limit = 3; // B·∫°n c√≥ th·ªÉ ch·ªânh th√†nh 4 n·∫øu mu·ªën hi·ªán 4 b√†i ƒë·∫ßu ti√™n
        const hasMore = posts.length > limit;
        const sectionId = `section-${title.replace(/\s+/g, '-')}`;

        return `
            <div class="category-divider" data-aos="fade-right">
                <h2>${title}</h2>
                <div class="line"></div>
            </div>
            <div id="${sectionId}" class="blog-group">
                ${renderPosts(posts.slice(0, limit))}
            </div>
            ${hasMore ? `
                <div style="text-align: center; margin-bottom: 40px;">
                    <button class="btn-view-cat" onclick="expandCategory('${sectionId}', '${encodeURIComponent(JSON.stringify(posts))}')">
                        Xem t·∫•t c·∫£ b√†i vi·∫øt ${title}
                    </button>
                </div>
            ` : '<div style="margin-bottom: 40px;"></div>'}
        `;
    }

    function renderPosts(posts) {
        return posts.map(post => `
            <div class="blog-card" data-aos="zoom-in">
                <img src="${post.image || 'https://via.placeholder.com/400x200'}" alt="${post.title}">
                <div class="blog-card-body">
                    <span class="blog-category">${post.category}</span>
                    <h3 class="blog-title">${post.title}</h3>
                    <div class="blog-time">üìÖ ${post.time}</div>
                    <div class="blog-excerpt">${stripHtml(post.content).substring(0, 100)}...</div>
                    <a href="javascript:void(0)" onclick="viewPost('${encodeURIComponent(JSON.stringify(post))}')" class="btn-readmore">ƒê·ªçc th√™m ‚Üí</a>
                </div>
            </div>
        `).join('');
    }

    function expandCategory(id, encodedPosts) {
        const posts = JSON.parse(decodeURIComponent(encodedPosts));
        document.getElementById(id).innerHTML = renderPosts(posts);
        event.target.parentElement.style.display = 'none'; // ·∫®n n√∫t sau khi b·∫•m
    }

    function loadMorePosts() {
        visibleAllCount += 6;
        document.getElementById('all-posts-grid').innerHTML = renderPosts(allPosts.slice(0, visibleAllCount));
        if (visibleAllCount >= allPosts.length) {
            document.getElementById('load-more-all-container').style.display = 'none';
        }
    }

    // H√†m b·ªï tr·ª£ ƒë·ªÉ lo·∫°i b·ªè tag HTML khi hi·ªÉn th·ªã ƒëo·∫°n tr√≠ch d·∫´n (Excerpt)
    function stripHtml(html) {
    let tmp = document.createElement("DIV");
    tmp.innerHTML = html;
    return tmp.textContent || tmp.innerText || "";
    }
    // Ch·∫°y h√†m khi trang web t·∫£i xong
    window.addEventListener('DOMContentLoaded', loadBlogPosts);

        function createSnowflake(container) {
            const snowflake = document.createElement('div');
            snowflake.classList.add('snowflake');
            snowflake.innerHTML = '‚ùÑ'; 
            const size = Math.random() * 15 + 10 + 'px';
            snowflake.style.fontSize = size;
            snowflake.style.left = Math.random() * 100 + 'vw';
            const duration = Math.random() * 10 + 5 + 's';
            snowflake.style.animationDuration = duration;
            snowflake.style.animationDelay = Math.random() * 5 + 's';
            snowflake.style.opacity = Math.random() * 0.6 + 0.4;
            container.appendChild(snowflake);
            snowflake.addEventListener('animationiteration', function() {
                snowflake.remove();
                createSnowflake(container);
            });
            snowflake.addEventListener('animationend', function() {
                snowflake.remove();
                createSnowflake(container);
            });
        }
    });
    </script>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const menuToggle = document.querySelector('.menu-toggle');
            const nav = document.getElementById('main-nav');
            const header = document.querySelector('header');

            menuToggle.addEventListener('click', function() {
                nav.classList.toggle('nav-open'); 
                menuToggle.classList.toggle('menu-active'); 
                
                if (menuToggle.classList.contains('menu-active')) {
                    menuToggle.classList.remove('fa-bars');
                    menuToggle.classList.add('fa-times');
                } else {
                    menuToggle.classList.remove('fa-times');
                    menuToggle.classList.add('fa-bars');
                }

                document.body.classList.toggle('no-scroll');
            });
            
            nav.querySelectorAll('a').forEach(link => {
                link.addEventListener('click', () => {
                    if (nav.classList.contains('nav-open')) {
                        nav.classList.remove('nav-open');
                        menuToggle.classList.remove('menu-active', 'fa-times');
                        menuToggle.classList.add('fa-bars');
                        document.body.classList.remove('no-scroll');
                    }
                });
            });
            
            window.addEventListener('resize', function() {
                if (window.innerWidth > 768) {
                    nav.classList.remove('nav-open');
                    menuToggle.classList.remove('menu-active', 'fa-times');
                    menuToggle.classList.add('fa-bars');
                    document.body.classList.remove('no-scroll');
                }
            });
        });
        // C√ÅC H√ÄM N√ÄY PH·∫¢I ƒê·ªÇ NGO√ÄI C√ôNG
      function viewPost(encodedData) {
            const post = JSON.parse(decodeURIComponent(encodedData));
            const shareLink = `${window.location.origin}${window.location.pathname}?id=${encodeURIComponent(post.title)}`;
            document.getElementById('modal-content').innerHTML = `
                <div class="post-header">
                    <span style="color:#5b8cff; font-weight:bold; font-size:0.8em; text-transform:uppercase;">${post.category}</span>
                    <h1 style="font-size:1.6em; margin:10px 0; line-height:1.3;">${post.title}</h1>
                    <p style="color:#888; font-size:0.85em;">üìÖ ${post.time}</p>
                    <button onclick="copyToClipboard('${shareLink}')" style="background:#5b8cff; color:white; border:none; padding:5px 10px; border-radius:5px; cursor:pointer;">
                        <i class="fas fa-share-alt"></i> Sao ch√©p link
                    </button>
                </div>
                <hr style="border:0; border-top:1px dashed #eee; margin:20px 0;">
                <div class="post-full-content">${post.content}</div>
            `;
            document.getElementById('postModal').style.display = 'block';
            document.body.style.overflow = 'hidden'; // Ch·ªëng cu·ªôn trang ch√≠nh khi ƒëang xem b√†i
            window.history.pushState({}, '', `?id=${encodeURIComponent(post.title)}`);
        }

        function copyToClipboard(text) {
            navigator.clipboard.writeText(text).then(() => {
                alert("ƒê√£ sao ch√©p li√™n k·∫øt b√†i vi·∫øt!");
            });
        }

        function closePost() {
            document.getElementById('postModal').style.display = 'none';
            document.body.style.overflow = 'auto'; // M·ªü l·∫°i cu·ªôn
            window.history.pushState({}, '', window.location.pathname);
        }

        function stripHtml(html) {
            let t = document.createElement("DIV"); t.innerHTML = html;
            return t.textContent || t.innerText || "";
        }

        document.addEventListener('DOMContentLoaded', function() {
            // Load b√†i vi·∫øt
            async function loadPosts() {
                const res = await fetch("https://sheetdb.io/api/v1/stjh3ikcs21t8?sheet=Posts");
                const data = await res.json();
                document.getElementById('blog-container').innerHTML = data.reverse().map(p => `
                    <div class="blog-card">
                        <img src="${p.image || 'https://via.placeholder.com/400x200'}" style="width:100%; height:200px; object-fit:cover;">
                        <div style="padding:20px;">
                            <h3 style="margin:0 0 10px 0;">${p.title}</h3>
                            <p style="font-size:0.9em; color:#666;">${stripHtml(p.content).substring(0,100)}...</p>
                            <a href="javascript:void(0)" onclick="viewPost('${encodeURIComponent(JSON.stringify(p))}')" style="color:#5b8cff; font-weight:bold; text-decoration:none;">ƒê·ªçc th√™m ‚Üí</a>
                        </div>
                    </div>`).join('');
                const urlParams = new URLSearchParams(window.location.search);
                const postId = urlParams.get('id');
                
                if (postId) {
                    const targetPost = data.find(p => p.title === postId);
                    if (targetPost) {
                        viewPost(encodeURIComponent(JSON.stringify(targetPost)));
                    }
                }
            }
            loadPosts();
        });

        window.onclick = function(e) { if(e.target.id === 'postModal') closePost(); }
    </script>

    <div id="postModal">
        <div class="modal-container">
            <span class="close-btn" onclick="closePost()">&times;</span>
            <div id="modal-content">
                </div>
        </div>
    </div>

<script>
    async function includeHTML() {
            const components = [
            { id: 'header-placeholder', file: 'header.html' },
            { id: 'footer-placeholder', file: 'footer.html' }
        ];

        for (const comp of components) {
            const element = document.getElementById(comp.id);
            if (element) {
                try {
                    const response = await fetch(comp.file);
                    if (response.ok) {
                        element.innerHTML = await response.text();
                    }
                } catch (err) {
                    console.error("L·ªói khi t·∫£i file: " + comp.file, err);
                }
            }
        }

        // Sau khi t·∫£i xong c√°c file, ·∫©n v√≤ng xoay
        setTimeout(() => {
            const preloader = document.getElementById('preloader');
            if (preloader) {
                preloader.style.opacity = '0';
                preloader.style.visibility = 'hidden'; // ƒê·∫£m b·∫£o kh√¥ng b·∫•m nh·∫ßm v√†o preloader ·∫©n
                setTimeout(() => preloader.style.display = 'none', 500);
            }
        }, 600); // ƒê·ª£i 0.6s cho c·∫£m gi√°c m∆∞·ª£t m√†

        initMenuLogic();
    }
    function initMenuLogic() {
        const menuToggle = document.querySelector('.menu-toggle');
        const nav = document.getElementById('main-nav');

        // Ki·ªÉm tra xem c√°c ph·∫ßn t·ª≠ c√≥ t·ªìn t·∫°i kh√¥ng tr∆∞·ªõc khi g√°n s·ª± ki·ªán
        if (!menuToggle || !nav) return;

        menuToggle.addEventListener('click', function() {
            nav.classList.toggle('nav-open'); 
            menuToggle.classList.toggle('menu-active'); 
            
            if (menuToggle.classList.contains('menu-active')) {
                menuToggle.classList.remove('fa-bars');
                menuToggle.classList.add('fa-times');
            } else {
                menuToggle.classList.remove('fa-times');
                menuToggle.classList.add('fa-bars');
            }

            document.body.classList.toggle('no-scroll');
        });
        
        nav.querySelectorAll('a').forEach(link => {
            link.addEventListener('click', () => {
                if (nav.classList.contains('nav-open')) {
                    nav.classList.remove('nav-open');
                    menuToggle.classList.remove('menu-active', 'fa-times');
                    menuToggle.classList.add('fa-bars');
                    document.body.classList.remove('no-scroll');
                }
            });
        });
        
        window.addEventListener('resize', function() {
            if (window.innerWidth > 768) {
                nav.classList.remove('nav-open');
                menuToggle.classList.remove('menu-active', 'fa-times');
                menuToggle.classList.add('fa-bars');
                document.body.classList.remove('no-scroll');
            }
        });
    }

    // Ch·∫°y h√†m khi trang web t·∫£i xong
    document.addEventListener("DOMContentLoaded", includeHTML);
</script>

<script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
<script>
  AOS.init({
    duration: 1000, // T·ªëc ƒë·ªô hi·ªáu ·ª©ng (1 gi√¢y)
    once: true,     // Ch·ªâ ch·∫°y hi·ªáu ·ª©ng 1 l·∫ßn khi cu·ªôn xu·ªëng
  });
</script>

</body>
</html> 